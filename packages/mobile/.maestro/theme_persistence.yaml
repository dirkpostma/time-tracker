appId: com.anonymous.mobile
---
# Theme Persistence Test - Verifies theme selection persists across app restart

- launchApp:
    clearKeychain: true

# Handle dev client launcher
- tapOn:
    text: "http://localhost:8081"
    optional: true

# Wait for login screen
- extendedWaitUntil:
    visible: "Time Tracker"
    timeout: 30000

# Login
- tapOn:
    id: "email-input"
- inputText: "test@example.com"

- tapOn:
    id: "password-input"
- inputText: "Test1234"

- tapOn:
    id: "login-button"

# Dismiss iOS password save dialog
- tapOn:
    text: "Not Now"
    optional: true

# Wait for timer screen
- extendedWaitUntil:
    visible:
      id: "timer-display"
    timeout: 30000

# Stop any running timer
- tapOn:
    id: "stop-button"
    optional: true

- extendedWaitUntil:
    visible:
      id: "start-button"
    timeout: 10000

# Dismiss debug banner
- tapOn:
    text: "Ã—"
    optional: true

# ========== Set a non-default theme ==========

- tapOn:
    id: "tab-settings"

- extendedWaitUntil:
    visible:
      id: "theme-picker"
    timeout: 10000

# Take screenshot of initial state
- takeScreenshot: "theme_persistence_initial"

# Switch to Brutalist theme (easily visually distinguishable)
- tapOn:
    id: "theme-option-brutalist"

# Wait for theme to apply
- swipe:
    direction: DOWN
    duration: 500

- takeScreenshot: "theme_persistence_brutalist_set"

# Verify theme is applied in Settings
- assertVisible:
    id: "notifications-section"

# ========== Restart the app ==========

- stopApp

- launchApp:
    clearKeychain: false

# Handle dev client launcher again
- tapOn:
    text: "http://localhost:8081"
    optional: true

# Wait for app to load - should auto-login
- extendedWaitUntil:
    visible:
      id: "timer-display"
    timeout: 30000

# Take screenshot to verify theme persisted on Timer screen
- takeScreenshot: "theme_persistence_after_restart_timer"

# Navigate to Settings to verify theme selection
- tapOn:
    id: "tab-settings"

- extendedWaitUntil:
    visible:
      id: "theme-picker"
    timeout: 10000

# Take screenshot to verify Brutalist is still selected
- takeScreenshot: "theme_persistence_after_restart_settings"

# Verify theme picker shows Brutalist as selected
- assertVisible:
    id: "theme-option-brutalist"

# ========== Restore default theme for other tests ==========

- tapOn:
    id: "theme-option-midnightAurora"

- swipe:
    direction: DOWN
    duration: 300

# Verify restored
- assertVisible:
    id: "notifications-section"
